{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacaoService","_http","get","then","negociacoes","map","Date","objeto","data","quantidade","valor","catch","console","log","erro","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","periodos","reduce","arrayAchatado","array","concat","error","negociacao","getConnection","connection","dao","adiciona","listaTodos","apagaTodos","listaAtual","obterNegociacoes","filter","some","negociacaoLista","isEquals"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["import {HttpService} from './HttpService';\r\nimport {ConnectionFactory} from './ConnectionFactory';\r\nimport {NegociacaoDao} from '../dao/NegociacaoDao';\r\nimport {Negociacao} from '../models/Negociacao';\r\n\r\nexport class NegociacaoService{\r\n\r\n    constructor(){\r\n        this._http = new HttpService();\r\n    }\r\n\r\n    obterNegociacoesDaSemana(){\r\n        \r\n        return this._http\r\n                .get('negociacoes/semana')\r\n                .then(negociacoes => {\r\n                    return negociacoes.map( objeto => new Negociacao( new Date(objeto.data), objeto.quantidade, objeto.valor ));\r\n                })\r\n                .catch( erro => {\r\n                    console.log(erro);\r\n                    throw new Error('N�o foi possivel obter as negociacoes da semana');\r\n                });\r\n            \r\n    }\r\n    \r\n    obterNegociacoesDaSemanaAnterior(){\r\n        \r\n        return this._http\r\n                .get('negociacoes/anterior')\r\n                .then(negociacoes => {\r\n                    return (negociacoes.map( objeto => new Negociacao( new Date(objeto.data), objeto.quantidade, objeto.valor )));\r\n                })\r\n                .catch( erro => {\r\n                    console.log(erro);\r\n                    throw new Error('N�o foi possivel obter as negociacoes da semana anterior');\r\n                });\r\n    }\r\n\r\n    obterNegociacoesDaSemanaRetrasada(){\r\n        \r\n        return this._http\r\n                .get('negociacoes/retrasada')\r\n                .then(negociacoes => {\r\n                     return (negociacoes.map( objeto => new Negociacao( new Date(objeto.data), objeto.quantidade, objeto.valor )));\r\n                })\r\n                .catch( erro => {\r\n                    console.log(erro);\r\n                    throw new Error('N�o foi possivel obter as negociacoes da semana retrasada');\r\n                });\r\n        \r\n    }\r\n\r\n    obterNegociacoes(){\r\n        return Promise.all( [this.obterNegociacoesDaSemana(), \r\n                            this.obterNegociacoesDaSemanaAnterior(), \r\n                            this.obterNegociacoesDaSemanaRetrasada()])\r\n                        .then(periodos => {\r\n                                            let negociacoes = periodos;\r\n                                            return (negociacoes.reduce((arrayAchatado, array)=> arrayAchatado.concat(array),[]))\r\n                        })\r\n                        .catch( error => {throw new Error(error)} );\r\n    }\r\n\r\n    cadastra( negociacao ){\r\n            \r\n          return  ConnectionFactory.getConnection()\r\n                             .then( connection => new NegociacaoDao(connection))\r\n                             .then( dao => dao.adiciona(negociacao))\r\n                             .then(()=> 'Negocia��o adicionada com sucesso')\r\n                             .catch( () => {throw new Error('N�o foi poss�vel adicionar a negocia��o')});\r\n    }\r\n\r\n    lista(){\r\n        \r\n        return ConnectionFactory.getConnection()\r\n                                .then( connection => new NegociacaoDao(connection))\r\n                                .then( dao => dao.listaTodos() )\r\n                                .catch( erro => {\r\n                                    console.log(erro)\r\n                                    throw new Error('N�o foi possivel obter as negocia��es');\r\n                                });\r\n\r\n    }\r\n\r\n    apaga(){\r\n        return ConnectionFactory.getConnection()\r\n                                 .then( connection => new NegociacaoDao(connection))\r\n                                 .then(dao => dao.apagaTodos())\r\n                                 .then( () => 'Negocia��es apagadas com sucesso' )\r\n                                 .catch( erro => {\r\n                                    console.log(erro);\r\n                                    throw new Error('N�o foi possivel apagar as negocia��es')\r\n                                 } );\r\n    }\r\n\r\n    importa( listaAtual ){\r\n        return this.obterNegociacoes()\r\n                    .then(negociacoes => negociacoes.filter( negociacao => \r\n                        !listaAtual.some( negociacaoLista =>  negociacaoLista.isEquals(negociacao) ) ) )\r\n                    .catch(error => {\r\n                            console.log(error);\r\n                            throw new Error('N�o foi possivel importar a lista de negocia��es');\r\n                    });\r\n    }\r\n\r\n}"]}