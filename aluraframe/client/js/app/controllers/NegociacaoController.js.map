{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputQuantidade","_inputData","_inputValor","_ordemAtual","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","MensagemView","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","error","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","apaga","esvazia","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n\r\n    constructor(){\r\n        let $ = document.querySelector.bind(document);\r\n        this._inputQuantidade = $(\"#quantidade\");\r\n        this._inputData = $(\"#data\");\r\n        this._inputValor = $(\"#valor\");\r\n        this._ordemAtual = '';\r\n        \r\n        this._listaNegociacoes = new Bind( new ListaNegociacoes(),\r\n                                            new NegociacoesView($(\"#negociacoesView\")),\r\n                                            'adiciona', 'esvazia', 'ordena', 'inverteOrdem' );\r\n\r\n        this._mensagem = new Bind( new MensagemView(),\r\n                                    new MensagemView($(\"#mensagemView\")),\r\n                                    'texto');\r\n        \r\n        this._service = new NegociacaoService();                                    \r\n        this._init();\r\n        \r\n            \r\n    }\r\n\r\n    _init(){\r\n\r\n        this._service\r\n            .lista()\r\n            .then(negociacoes => negociacoes.forEach( negociacao => this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch( erro => this._mensagem.texto = erro);\r\n        \r\n        setInterval( () => {\r\n            this.importaNegociacoes();\r\n        }, 3000 );\r\n    }\r\n\r\n    adiciona(event){\r\n        event.preventDefault();\r\n        \r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then( mensagem => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch( erro => this._mensagem.texto = erro );\r\n\r\n        \r\n    }\r\n\r\n    importaNegociacoes(){\r\n\r\n        this._service.importa( this._listaNegociacoes.negociacoes )\r\n                        .then(negociacoes => {\r\n                            negociacoes\r\n                                .forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\r\n                            this._mensagem.texto = 'Negocia��es importadas com sucesso';\r\n                        })\r\n                    .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao( DateHelper.textoParaData(this._inputData.value), \r\n                                parseInt(this._inputQuantidade.value), \r\n                                parseFloat(this._inputValor.value ));\r\n    }\r\n\r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    apaga(){\r\n       \r\n        this._service\r\n            .apaga()\r\n            .then()\r\n            .then(mensagem => {\r\n                this._mensagem.texto = mensagem;\r\n                this._listaNegociacoes.esvazia();\r\n            })\r\n            .catch( erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    ordena( coluna ){\r\n        if ( this._ordemAtual == coluna ){\r\n            this._listaNegociacoes.inverteOrdem();    \r\n        }else{\r\n            this._listaNegociacoes.ordena( (a, b) => a[coluna] - b[coluna] );\r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n}"]}